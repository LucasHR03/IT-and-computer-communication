<!doctype html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EPJ Dashboard</title>

  <!-- Ekstern CSS -->
  <link rel="stylesheet" href="static/css/dashboard.css" />
</head>
<body>
  <header>
    <h1>Elektronisk Patientjournal System</h1>
    <div id="user-info" aria-label="Brugerinformation">
      Bruger: <span id="user-name">
        <% req.write(session.get('user_name', 'Ukendt')) %>
      </span>
      <span class="role-badge" id="user-role">
        <% req.write(session.get('user_role', 'Ingen rolle')) %>
      </span>
    </div>
    <form action="logout.psp" method="post" style="display:inline;">
      <button id="logout-btn" aria-label="Log ud">Log ud</button>
    </form>
  </header>

  <nav aria-label="Prim√¶r navigation">
    <button data-section="patientdata" class="nav-btn active">Patientidentitet &amp; Basisdata</button>
    <button data-section="journalnotater" class="nav-btn">Journalnotater &amp; Dokumentation</button>
    <button data-section="diagnoser" class="nav-btn">Diagnoseliste &amp; ICD-koder</button>
    <button data-section="allergier" class="nav-btn">Allergier &amp; Intoleranser</button>
    <button data-section="medicin" class="nav-btn">Medicin &amp; Ordinationer</button>
    <button data-section="audit" class="nav-btn">Audit &amp; Logning</button>
  </nav>

  <main>
    <!-- Patientdata -->
    <section id="patientdata" class="section active">
      <h2>üìã Patientidentitet &amp; Basisdata</h2>
      <form id="patient-form" method="post" action="save_patient.psp">
        <fieldset>
          <legend>Registrer ny patient</legend>
          <label for="cpr">CPR/ID *</label>
          <input type="text" id="cpr" name="cpr" required maxlength="11" placeholder="123456-7890" />

          <label for="navn">Fulde navn *</label>
          <input type="text" id="navn" name="navn" required placeholder="Fornavn Efternavn" />

          <label for="kontakt">Kontaktoplysninger *</label>
          <input type="text" id="kontakt" name="kontakt" required placeholder="Telefon eller email" />

          <label for="paarorende">P√•r√∏rende kontakt</label>
          <input type="text" id="paarorende" name="paarorende" placeholder="Navn og telefon" />

          <label for="samtykke">Informeret samtykke *</label>
          <select id="samtykke" name="samtykke" required>
            <option value="">V√¶lg samtykke status</option>
            <option value="ja">Ja - Samtykke givet</option>
            <option value="nej">Nej - Samtykke n√¶gtet</option>
          </select>

          <button type="submit">Gem patient i system</button>
        </fieldset>
      </form>

      <div class="list-header">
        <h3>Registrerede patienter</h3>
        <div>
          <button class="export-btn" id="export-patients">Eksporter data</button>
          <input type="file" id="import-patients-file" accept=".json" style="display:none" />
          <button class="import-btn" id="import-patients">Importer data</button>
        </div>
      </div>
      <ul id="patient-list"></ul>
    </section>

    <!-- Journalnotater -->
    <section id="journalnotater" class="section">
      <h2>üìù Journalnotater &amp; Dokumentation</h2>
      <form id="journal-form" method="post" action="save_journal.psp">
        <fieldset>
          <legend>Opret nyt journalnotat</legend>
          <label for="journal-patient-cpr">Patient CPR *</label>
          <input type="text" id="journal-patient-cpr" name="cpr" required maxlength="11" placeholder="123456-7890" />
          <label for="journal-type">Type af notat</label>
          <select id="journal-type" name="type">
            <option value="konsultation">Konsultation</option>
            <option value="observation">Observation</option>
            <option value="behandling">Behandling</option>
            <option value="andet">Andet</option>
          </select>
          <label for="journal-text">Journalnotat *</label>
          <textarea id="journal-text" name="tekst" rows="4" required placeholder="Beskriv patientkontakt..."></textarea>
          <button type="submit">Gem journalnotat</button>
        </fieldset>
      </form>
      <div class="list-header">
        <h3>Journalnotater</h3>
        <div>
          <button class="export-btn" id="export-journal">Eksporter</button>
          <input type="file" id="import-journal-file" accept=".json" style="display:none" />
          <button class="import-btn" id="import-journal">Importer</button>
        </div>
      </div>
      <ul id="journal-list"></ul>
    </section>

    <!-- Diagnoser -->
    <section id="diagnoser" class="section">
      <h2>üè• Diagnoseliste &amp; ICD-koder</h2>
      <form id="diagnose-form" method="post" action="save_diagnose.psp">
        <fieldset>
          <legend>Tilf√∏j ny diagnose</legend>
          <label for="diagnose-cpr">Patient CPR *</label>
          <input type="text" id="diagnose-cpr" name="cpr" required maxlength="11" placeholder="123456-7890" />
          <label for="diagnose-text">Diagnose *</label>
          <input type="text" id="diagnose-text" name="tekst" required placeholder="F.eks. Diabetes Type 2" />
          <label for="diagnose-status">Diagnose status *</label>
          <select id="diagnose-status" name="status" required>
            <option value="aktiv">Aktiv</option>
            <option value="historisk">Historisk</option>
            <option value="mist√¶nkt">Mist√¶nkt</option>
          </select>
          <button type="submit">Registrer diagnose</button>
        </fieldset>
      </form>
      <ul id="diagnose-list"></ul>
    </section>

    <!-- Allergier -->
    <section id="allergier" class="section">
      <h2>‚ö†Ô∏è Allergier &amp; Intoleranser</h2>
      <form id="allergi-form" method="post" action="save_allergi.psp">
        <fieldset>
          <legend>Registrer allergi</legend>
          <label for="allergi-cpr">Patient CPR *</label>
          <input type="text" id="allergi-cpr" name="cpr" required maxlength="11" placeholder="123456-7890" />
          <label for="allergi-text">Allergen/Substans *</label>
          <input type="text" id="allergi-text" name="stof" required placeholder="F.eks. Penicillin" />
          <label for="allergi-reaction">Reaktion</label>
          <input type="text" id="allergi-reaction" name="reaktion" placeholder="Udsl√¶t, √Önden√∏d" />
          <label for="allergi-severity">Sv√¶rhedsgrad *</label>
          <select id="allergi-severity" name="svaerhedsgrad" required>
            <option value="mild">Mild</option>
            <option value="moderat">Moderat</option>
            <option value="sv√¶r">Sv√¶r</option>
          </select>
          <button type="submit">Gem allergi</button>
        </fieldset>
      </form>
      <ul id="allergi-list"></ul>
    </section>

    <!-- Medicin -->
    <section id="medicin" class="section">
      <h2>üíä Medicin &amp; Ordinationer</h2>
      <form id="medicin-form" method="post" action="save_medicin.psp">
        <fieldset>
          <legend>Ny ordination</legend>
          <label for="medicin-cpr">Patient CPR *</label>
          <input type="text" id="medicin-cpr" name="cpr" required maxlength="11" placeholder="123456-7890" />
          <label for="medicin-name">Medicin navn *</label>
          <input type="text" id="medicin-name" name="navn" required placeholder="Paracetamol" />
          <label for="medicin-dosage">Dosering</label>
          <input type="text" id="medicin-dosage" name="dosering" placeholder="500mg" />
          <label for="medicin-frequency">Frekvens</label>
          <input type="text" id="medicin-frequency" name="frekvens" placeholder="3x dagligt" />
          <label for="medicin-status">Status</label>
          <select id="medicin-status" name="status">
            <option value="aktiv">Aktiv</option>
            <option value="seponeret">Seponeret</option>
            <option value="midlertidig">Midlertidig</option>
          </select>
          <button type="submit">Gem ordination</button>
        </fieldset>
      </form>
      <ul id="medicin-list"></ul>
    </section>

    <!-- Audit -->
    <section id="audit" class="section">
      <h2>üîç Audit &amp; Logning</h2>
      <div class="list-header">
        <h3>Systemaktivitet</h3>
        <button id="clear-audit" class="danger">Ryd log</button>
      </div>
      <ul id="audit-list"></ul>
    </section>
  </main>

  <!-- Ekstern JavaScript -->
  <script src="static/js/dashboard.js"></script>
</body>
</html>
